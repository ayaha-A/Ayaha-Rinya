<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>exhibition hall</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#000000',
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .box-shadow-custom {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            }
            .transition-custom {
                transition: all 0.2s ease;
            }
            .hidden-admin {
                opacity: 0;
                height: 0;
                overflow: hidden;
                transition: all 0.3s ease;
            }
            .show-admin {
                opacity: 1;
                height: auto;
                margin-bottom: 1rem;
            }
            .link-effect {
                @apply relative inline-block transition-all duration-300;
            }
            .link-effect::after {
                @apply content-[''] absolute w-0 h-0.5 bg-primary left-0 bottom-0 transition-all duration-300;
            }
            .link-effect:hover::after {
                @apply w-full;
            }
            .editable-text:hover {
                @apply bg-gray-100;
            }
            .image-upload-area {
                @apply cursor-pointer transition-all hover:opacity-80;
            }
            .image-upload-overlay {
                @apply absolute inset-0 bg-black/50 opacity-0 flex items-center justify-center transition-all hover:opacity-100;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen p-4 md:p-8">
    <!-- 顶部区域：左上角图片和右上角文本 -->
    <div class="max-w-4xl mx-auto mb-8 flex justify-between items-start">
        <!-- 左上角图片上传区域 -->
        <div class="relative image-upload-area" style="width: 120px; height: 80px;">
            <img id="header-image" src="" alt="头部图片" class="max-w-full max-h-full object-contain">
            <div id="image-upload-overlay" class="image-upload-overlay hidden">
                <i class="fa fa-upload text-white text-xl"></i>
            </div>
            <input type="file" id="image-input" accept="image/*" class="absolute inset-0 w-full h-full opacity-0 cursor-pointer hidden">
        </div>
        
        <!-- 右上角可编辑文本 -->
        <div class="text-right">
            <div id="top-right-text" class="text-gray-800 text-lg md:text-xl editable-text px-2 py-1 cursor-default">
                A collection of street views​
            </div>
        </div>
    </div>
    
    <!-- 隐藏的管理员登录区域 -->
    <div id="admin-login" class="max-w-md mx-auto p-4 bg-white rounded-lg box-shadow-custom hidden-admin">
        <h3 class="text-lg font-medium text-gray-800 mb-3">login</h3>
        <input type="password" id="admin-password" class="w-full px-4 py-2 border border-gray-300 rounded-lg mb-3" placeholder="password">
        <button id="login-btn" class="w-full bg-primary text-white py-2 rounded-lg hover:bg-primary/90 transition-custom">sign in</button>
    </div>
    
    <!-- 页面标题和管理员控制区 -->
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800">A collection of street views​</h1>
        <div class="flex items-center justify-center mt-2">
            <p id="admin-indicator" class="text-green-600 mr-4 hidden">This is Administrator</p>
            <!-- 退出管理员按钮 -->
            <button id="logout-btn" class="text-red-500 text-sm hover:underline hidden">
                <i class="fa fa-sign-out mr-1"></i>Exit
            </button>
        </div>
    </div>
    
    <!-- 展示框容器 -->
    <div id="boxes-container" class="max-w-4xl mx-auto space-y-6">
        <!-- 展示框将通过JS动态添加 -->
    </div>
    
    <!-- 添加新框按钮 (管理员可见) -->
    <div id="add-box-container" class="max-w-4xl mx-auto mt-8 mb-16 text-center hidden">
        <button id="add-box-btn" class="bg-primary hover:bg-primary/90 text-white font-medium py-3 px-6 rounded-lg transition-custom flex items-center justify-center mx-auto">
            <i class="fa fa-plus mr-2"></i> 
        </button>
    </div>

    <!-- 编辑文本和链接的模态框 (管理员可见) -->
    <div id="edit-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 w-full max-w-md">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">编辑内容和链接</h3>
            <input type="text" id="text-input" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent mb-4" placeholder="输入显示文本">
            <input type="url" id="url-input" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent mb-4" placeholder="输入链接地址 (https://...)">
            <div class="flex justify-end space-x-3">
                <button id="cancel-btn" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-custom">取消</button>
                <button id="save-btn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-custom">保存</button>
            </div>
        </div>
    </div>

    <!-- 编辑右上角文本的模态框 -->
    <div id="text-edit-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-6 w-full max-w-md">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">编辑文本</h3>
            <input type="text" id="top-text-input" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent mb-4" placeholder="输入文本内容">
            <div class="flex justify-end space-x-3">
                <button id="cancel-text-btn" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-custom">取消</button>
                <button id="save-text-btn" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-custom">保存</button>
            </div>
        </div>
    </div>

    <script>
        // 配置
        const ADMIN_PASSWORD = "7410";
        const ADMIN_TRIGGER = "editmode";
        
        // 状态变量
        let isAdmin = false;
        let currentBoxId = null;
        let triggerInput = "";
        
        // 初始化
        function init() {
            checkAdminLoginStatus();
            loadHeaderImage();
            loadTopRightText();
            loadBoxes();
            
            if (document.querySelectorAll('.text-box').length === 0) {
                addDefaultBox();
            }
            
            // 事件监听
            document.getElementById('add-box-btn').addEventListener('click', () => addNewBox('新链接', 'https://example.com'));
            document.getElementById('save-btn').addEventListener('click', saveEditContent);
            document.getElementById('cancel-btn').addEventListener('click', closeEditModal);
            document.getElementById('login-btn').addEventListener('click', loginAsAdmin);
            document.getElementById('save-text-btn').addEventListener('click', saveTopRightText);
            document.getElementById('cancel-text-btn').addEventListener('click', closeTextEditModal);
            document.getElementById('image-input').addEventListener('change', handleImageUpload);
            
            // 新增：退出按钮事件
            document.getElementById('logout-btn').addEventListener('click', logoutAdmin);
            
            document.getElementById('top-right-text').addEventListener('click', function() {
                if (isAdmin) {
                    openTextEditModal();
                }
            });
            
            const imageArea = document.querySelector('.image-upload-area');
            const imageOverlay = document.getElementById('image-upload-overlay');
            
            imageArea.addEventListener('mouseenter', function() {
                if (isAdmin) {
                    imageOverlay.classList.remove('hidden');
                }
            });
            
            imageArea.addEventListener('mouseleave', function() {
                imageOverlay.classList.add('hidden');
            });
            
            imageArea.addEventListener('click', function() {
                if (isAdmin) {
                    document.getElementById('image-input').click();
                }
            });
            
            // 管理员触发机制
            let titleClickCount = 0;
            document.querySelector('h1').addEventListener('click', function() {
                titleClickCount++;
                if (titleClickCount >= 5) {
                    showAdminLogin();
                    titleClickCount = 0;
                }
                setTimeout(() => {
                    if (titleClickCount < 5) titleClickCount = 0;
                }, 3000);
            });
            
            document.addEventListener('keydown', function(e) {
                if (e.key.length === 1 && e.key.match(/[a-zA-Z0-9]/)) {
                    triggerInput += e.key.toLowerCase();
                    if (triggerInput.length > ADMIN_TRIGGER.length) {
                        triggerInput = triggerInput.slice(-ADMIN_TRIGGER.length);
                    }
                    if (triggerInput === ADMIN_TRIGGER) {
                        showAdminLogin();
                        triggerInput = "";
                    }
                }
            });
        }
        
        // 新增：管理员退出功能
        function logoutAdmin() {
            if (confirm('确定要退出管理员模式吗？')) {
                localStorage.removeItem('isAdminLoggedIn');
                isAdmin = false;
                
                // 隐藏管理员元素
                document.getElementById('admin-indicator').classList.add('hidden');
                document.getElementById('logout-btn').classList.add('hidden');
                document.getElementById('add-box-container').classList.add('hidden');
                document.getElementById('image-input').classList.add('hidden');
                document.getElementById('top-right-text').classList.remove('cursor-pointer');
                
                // 移除编辑事件，恢复链接功能
                document.querySelectorAll('.text-content').forEach(element => {
                    element.classList.remove('cursor-pointer', 'hover:text-primary');
                    
                    // 移除所有点击事件并恢复链接功能
                    const newElement = element.cloneNode(true);
                    element.parentNode.replaceChild(newElement, element);
                });
                
                // 刷新页面效果更彻底
                location.reload();
            }
        }
        
        // 其他原有函数保持不变
        function showAdminLogin() {
            if (isAdmin) return;
            document.getElementById('admin-login').classList.add('show-admin');
            document.getElementById('admin-password').focus();
        }
        
        function checkAdminLoginStatus() {
            const loginStatus = localStorage.getItem('isAdminLoggedIn');
            if (loginStatus === 'true') {
                enableAdminMode();
            }
        }
        
        function loginAsAdmin() {
            const passwordInput = document.getElementById('admin-password');
            const enteredPassword = passwordInput.value.trim();
            
            if (enteredPassword === ADMIN_PASSWORD) {
                localStorage.setItem('isAdminLoggedIn', 'true');
                enableAdminMode();
                document.getElementById('admin-login').classList.remove('show-admin');
                passwordInput.value = '';
            } else {
                alert('密码错误');
                passwordInput.value = '';
                passwordInput.focus();
            }
        }
        
        function enableAdminMode() {
            isAdmin = true;
            document.getElementById('admin-indicator').classList.remove('hidden');
            document.getElementById('logout-btn').classList.remove('hidden'); // 显示退出按钮
            document.getElementById('add-box-container').classList.remove('hidden');
            document.getElementById('image-input').classList.remove('hidden');
            document.getElementById('top-right-text').classList.add('cursor-pointer');
            
            document.querySelectorAll('.text-content').forEach(element => {
                element.classList.add('cursor-pointer', 'hover:text-primary');
                element.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const boxId = this.closest('.text-box').id;
                    const text = this.textContent;
                    const url = this.getAttribute('href');
                    openEditModal(boxId, text, url);
                });
            });
            
            document.querySelectorAll('.text-box').forEach(box => {
                box.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    if (confirm('确定要删除这个展示框吗？')) {
                        const boxId = this.id;
                        deleteBox(boxId);
                    }
                });
            });
        }
        
        // 以下为其他原有函数，保持不变
        function generateId() {
            return 'box_' + Date.now() + '_' + Math.floor(Math.random() * 1000);
        }
        
        function addDefaultBox() {
            const boxId = generateId();
            const defaultText = "示例链接";
            const defaultUrl = "https://example.com";
            
            const box = document.createElement('div');
            box.id = boxId;
            box.className = 'text-box bg-white rounded-xl p-6 box-shadow-custom transition-custom hover:shadow-lg';
            
            box.innerHTML = `
                <a href="${defaultUrl}" target="_blank" class="text-content link-effect text-2xl md:text-3xl font-medium text-gray-800 ${isAdmin ? 'cursor-pointer hover:text-primary' : ''}">
                    ${defaultText}
                </a>
            `;
            
            document.getElementById('boxes-container').appendChild(box);
            
            if (isAdmin) {
                box.querySelector('.text-content').addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    openEditModal(boxId, defaultText, defaultUrl);
                });
                
                box.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                    if (confirm('确定要删除这个展示框吗？')) {
                        deleteBox(boxId);
                    }
                });
            }
            
            saveBoxToStorage(boxId, defaultText, defaultUrl);
        }
        
        function addNewBox(defaultText, defaultUrl) {
            if (!isAdmin) return;
            
            const boxId = generateId();
            const box = document.createElement('div');
            box.id = boxId;
            box.className = 'text-box bg-white rounded-xl p-6 box-shadow-custom transition-custom hover:shadow-lg';
            
            box.innerHTML = `
                <a href="${defaultUrl}" target="_blank" class="text-content link-effect text-2xl md:text-3xl font-medium text-gray-800 cursor-pointer hover:text-primary">
                    ${defaultText}
                </a>
            `;
            
            document.getElementById('boxes-container').appendChild(box);
            
            box.querySelector('.text-content').addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                openEditModal(boxId, defaultText, defaultUrl);
            });
            
            box.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                if (confirm('oh,Are you sure?')) {
                    deleteBox(boxId);
                }
            });
            
            saveBoxToStorage(boxId, defaultText, defaultUrl);
            
            box.style.opacity = '0';
            box.style.transform = 'translateY(10px)';
            setTimeout(() => {
                box.style.opacity = '1';
                box.style.transform = 'translateY(0)';
            }, 10);
        }
        
        function openEditModal(boxId, currentText, currentUrl) {
            if (!isAdmin) return;
            
            currentBoxId = boxId;
            document.getElementById('text-input').value = currentText;
            document.getElementById('url-input').value = currentUrl;
            document.getElementById('edit-modal').classList.remove('hidden');
            document.getElementById('text-input').focus();
        }
        
        function closeEditModal() {
            currentBoxId = null;
            document.getElementById('edit-modal').classList.add('hidden');
        }
        
        function saveEditContent() {
            if (!isAdmin || !currentBoxId) return;
            
            const newText = document.getElementById('text-input').value.trim() || '未命名';
            let newUrl = document.getElementById('url-input').value.trim() || 'https://example.com';
            
            if (!newUrl.startsWith('http://') && !newUrl.startsWith('https://')) {
                newUrl = 'https://' + newUrl;
            }
            
            const box = document.getElementById(currentBoxId);
            if (box) {
                const linkElement = box.querySelector('.text-content');
                linkElement.textContent = newText;
                linkElement.href = newUrl;
                saveBoxToStorage(currentBoxId, newText, newUrl);
            }
            
            closeEditModal();
        }
        
        function deleteBox(boxId) {
            if (!isAdmin) return;
            
            const box = document.getElementById(boxId);
            if (box) {
                box.style.opacity = '0';
                box.style.transform = 'translateY(10px)';
                
                setTimeout(() => {
                    box.remove();
                    removeBoxFromStorage(boxId);
                }, 200);
            }
        }
        
        function openTextEditModal() {
            if (!isAdmin) return;
            
            const currentText = document.getElementById('top-right-text').textContent;
            document.getElementById('top-text-input').value = currentText;
            document.getElementById('text-edit-modal').classList.remove('hidden');
            document.getElementById('top-text-input').focus();
        }
        
        function closeTextEditModal() {
            document.getElementById('text-edit-modal').classList.add('hidden');
        }
        
        function saveTopRightText() {
            if (!isAdmin) return;
            
            const newText = document.getElementById('top-text-input').value.trim() || '右上角文本';
            document.getElementById('top-right-text').textContent = newText;
            localStorage.setItem('topRightText', newText);
            closeTextEditModal();
        }
        
        function handleImageUpload(e) {
            if (!isAdmin) return;
            
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    const imageUrl = event.target.result;
                    document.getElementById('header-image').src = imageUrl;
                    localStorage.setItem('headerImage', imageUrl);
                };
                
                reader.readAsDataURL(file);
            }
        }
        
        function loadHeaderImage() {
            const savedImage = localStorage.getItem('headerImage');
            if (savedImage) {
                document.getElementById('header-image').src = savedImage;
            }
        }
        
        function loadTopRightText() {
            const savedText = localStorage.getItem('topRightText') || 'A collection of street views​';
            document.getElementById('top-right-text').textContent = savedText;
        }
        
        function saveBoxToStorage(boxId, text, url) {
            let boxes = JSON.parse(localStorage.getItem('customBoxes') || '{}');
            boxes[boxId] = { text, url };
            localStorage.setItem('customBoxes', JSON.stringify(boxes));
        }
        
        function removeBoxFromStorage(boxId) {
            let boxes = JSON.parse(localStorage.getItem('customBoxes') || '{}');
            delete boxes[boxId];
            localStorage.setItem('customBoxes', JSON.stringify(boxes));
        }
        
        function loadBoxes() {
            const boxes = JSON.parse(localStorage.getItem('customBoxes') || '{}');
            
            for (const [boxId, data] of Object.entries(boxes)) {
                const { text, url } = data;
                
                const box = document.createElement('div');
                box.id = boxId;
                box.className = 'text-box bg-white rounded-xl p-6 box-shadow-custom transition-custom hover:shadow-lg';
                
                box.innerHTML = `
                    <a href="${url}" target="_blank" class="text-content link-effect text-2xl md:text-3xl font-medium text-gray-800 ${isAdmin ? 'cursor-pointer hover:text-primary' : ''}">
                        ${text}
                    </a>
                `;
                
                document.getElementById('boxes-container').appendChild(box);
                
                if (isAdmin) {
                    box.querySelector('.text-content').addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        openEditModal(boxId, text, url);
                    });
                    
                    box.addEventListener('contextmenu', function(e) {
                        e.preventDefault();
                        if (confirm('oh,Are you sure?')) {
                            deleteBox(boxId);
                        }
                    });
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', init);
    </script>

</body></html>
    